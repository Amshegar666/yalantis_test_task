## Стек технологий

- node.js v14.17.5 +

## Описание

Веб-приложение "Секретный санта"  
Спроектировано на базе фреймворка nest.js

После запуска приложения становится доступна главная страница приложения:  
localhost:3000 по умолчанию, на ней можно зарегестрироваться и войти в уже созданный кабинет

по странице localhost:3000/adminpanel доступна функция перемешивания и определения сант  
данная функция доступна к запуску в случае наличия в системе 3-500 пользователей и ввода спец. кода

## Конфигурация
переменные окружения (.env)  
MAX_USER_LIMIT_FOR_SHUFFLE - максимальное количество пользователей в системе  
MIN_USER_LIMIT_FOR_SHUFFLE - минимальное количество пользователей для запуска перемешивания  
SECRET_CODE_FOR_SHUFFLE - код для запуска перемешивания  
PORT - порт запуска приложения

## Установка зависимостей

```bash
$ npm install
```

## Компиляция

```bash
$ npm run build
```

## Запуск приложения

```bash
# development
$ npm run start

# watch mode
$ npm run start:dev

# production mode
$ npm run start:prod
```

## URL-ы

### / (GET)
#### Входные параметры
+ нет параметров
#### Описание
+ главная страница приложения. в случае, если смешивание пользоветелй не произошло, и не достигнут лимит пользователей - предоставляет возможность зарегестрироваться. в любом случае доступна возможность зайти к себе в "кабинет"

### /api (GET)
#### Входные параметры
+ нет параметров
#### Описание
+ swagger описание endpoints

### /lookAll (GET)
#### Входные параметры
+ нет параметров
#### Описание
+ получения массива всех пользователей проекта (для тестирования)

### /lookConfig (GET)
#### Входные параметры
+ нет параметров
#### Описание
+ получение массива конфигов из базы данных (для тестирования)

### /adminpanel (GET)
#### Входные параметры
+ нет параметров
#### Описание
+ страница с информацией для запуска смешивания, для запуска смешивания необходимо ввести код, код берёться из окружения.

### /shuffle (POST)
#### Входные параметры
+ **code** (string);
#### Описание
+ страница запуска смешивания пользователей, возможен только 1 запуск без обнуления базы данных. для запуска необходим код.

### /dashboard/:id (GET)
#### Входные параметры
+ нет параметров
#### Описание
+ проверка на существование пользователя с user.id == id и проверка соответствия id из сессии - id из запроса
    + в случае неудачи выводиться страница с сообщением "Нет доступа"
    + в случае успеха - пользователь попадает в свой кабинет, где может корректировать свои данные(Имя, Фамилия, Желаемый подарок 1-10) и, в случае свершённого смешивания, видит данные того, кому становится секретным сантой - его логин, имя, фамилию и желаемые подарки

### /update/:id (POST)
#### Входные параметры
+ **postData** (object); имеет вид { **name**, **surname**, **gift1**, **gift2**, **gift3**, **gift4**, **gift5**, **gift6**, **gift7**, **gift8**, **gift9**, **gift10** }
    + **name** (string) - имя пользователя (ОПЦИОНАЛЬНО)
    + **surname** (string) - фамилия пользователя (ОПЦИОНАЛЬНО)
    + **gift1** (string) - желаемый подарок 1 (ОПЦИОНАЛЬНО)
    + **gift2** (string) - желаемый подарок 2 (ОПЦИОНАЛЬНО)
    + **gift3** (string) - желаемый подарок 3 (ОПЦИОНАЛЬНО)
    + **gift4** (string) - желаемый подарок 4 (ОПЦИОНАЛЬНО)
    + **gift5** (string) - желаемый подарок 5 (ОПЦИОНАЛЬНО)
    + **gift6** (string) - желаемый подарок 6 (ОПЦИОНАЛЬНО)
    + **gift7** (string) - желаемый подарок 7 (ОПЦИОНАЛЬНО)
    + **gift8** (string) - желаемый подарок 8 (ОПЦИОНАЛЬНО)
    + **gift9** (string) - желаемый подарок 9 (ОПЦИОНАЛЬНО)
    + **gift10** (string) - желаемый подарок 10 (ОПЦИОНАЛЬНО)
#### Описание
+ сохранение\обновление данных пользователя

### /failed (GET)
#### Входные параметры
+ нет параметров
#### Описание
+ страница сообщений пользователю при ошибке валидации

### /exit (GET)
#### Входные параметры
+ нет параметров
#### Описание
+ страница выхода с кабинета и очистки id в сессии

### /signin (GET)
#### Входные параметры
+ нет параметров
#### Описание
+ страница с формой для входа в кабинет

### /signin (POST)
#### Входные параметры
+ **entityData** (object); имеет вид { **login**, **password** }
    + **login** (string) - логин пользователя
    + **password** (string) - пароль пользователя
#### Описание
+ url валидации и переадресации на страницу неудачи или в кабинет

### /signup (GET)
#### Входные параметры
+ нет параметров
#### Описание
+ страница с формой регистрации

### /signup (POST)
#### Входные параметры
+ **entityData** (object); имеет вид { **login**, **password** }
    + **login** (string) - логин пользователя
    + **password** (string) - пароль пользователя
#### Описание
+ url валидации и переадресации на страницу неудачи или в кабинет